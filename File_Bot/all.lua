local function all(msg)local text = msg.content_.text_function s_api(web) local info, res = https.request(web) local req = json:decode(info)if res ~= 200 then return false end if not req.ok then return falseend return req end local function sendText(chat_id, text, reply_to_message_id, markdown) send_api = "https://api.telegram.org/bot"..tokenlocal url = send_api..'/sendMessage?chat_id=' .. chat_id .. '&text=' .. URL.escape(text)if reply_to_message_id ~= 0 then url = url .. '&reply_to_message_id=' .. reply_to_message_id end if markdown == 'md' or markdown == 'markdown' then url = url..'&parse_mode=Markdown' elseif markdown == 'html' then url = url..'&parse_mode=HTML' end return s_api(url) endif text == "@all" and BasicConstructor(msg) or text == "all" and BasicConstructor(msg) thenif not database:get(bot_id..'Cick:all'..msg.chat_id_) thenif database:get(bot_id.."abbas:all:Time"..msg.chat_id_..':'..msg.sender_user_id_) then return send(msg.chat_id_, msg.id_,"*✯︙انتظر 7 دقائق من فضلك من فضلك\n✯︙ثم اعد المحاوله بعدها*")enddatabase:setex(bot_id..'abbas:all:Time'..msg.chat_id_..':'..msg.sender_user_id_,300,true)tdcli_function({ID="GetChannelFull",channel_id_ = msg.chat_id_:gsub('-100','')},function(argg,dataa) tdcli_function({ID = "GetChannelMembers",channel_id_ = msg.chat_id_:gsub('-100',''), offset_ = 0,limit_ = dataa.member_count_},function(ta,amir)x = 0tags = 0local list = amir.members_for k, v in pairs(list) dotdcli_function({ID="GetUser",user_id_ = v.user_id_},function(arg,data)if x == 5 or x == tags or k == 0 thentags = x + 5t = "#all"endx = x + 1tagname = data.first_name_tagname = tagname:gsub("]","")tagname = tagname:gsub("[[]","")t = t..", ["..tagname.."](tg://user?id="..v.user_id_..")"if x == 5 or x == tags or k == 0 thenlocal Text = t:gsub('#all,','#all\n')sendText(msg.chat_id_,Text,msg.id_/2097152/0.5,'md')endend,nil)endend,nil)end,nil)endendif text and (text:match("^@all (.*)$") or text:match("^all (.*)$")) and BasicConstructor(msg) thenAbsText = text:match("^@all (.*)$") or text:match("^all (.*)$")if not database:get(bot_id..'Cick:all'..msg.chat_id_) thenif database:get(bot_id.."abbas:all:Time"..msg.chat_id_..':'..msg.sender_user_id_) then return send(msg.chat_id_, msg.id_,"*✯︙انتظر 7 دقائق من فضلك من فضلك\n✯︙ثم اعد المحاوله بعدها*")enddatabase:setex(bot_id..'abbas:all:Time'..msg.chat_id_..':'..msg.sender_user_id_,300,true)tdcli_function({ID="GetChannelFull",channel_id_ = msg.chat_id_:gsub('-100','')},function(argg,dataa) tdcli_function({ID = "GetChannelMembers",channel_id_ = msg.chat_id_:gsub('-100',''), offset_ = 0,limit_ = dataa.member_count_},function(ta,amir)x = 0tags = 0local list = amir.members_for k, v in pairs(list) dotdcli_function({ID="GetUser",user_id_ = v.user_id_},function(arg,data)if x == 5 or x == tags or k == 0 thentags = x + 5t = "#all : "..AbsText.."\n\n"endx = x + 1tagname = data.first_name_tagname = tagname:gsub("]","")tagname = tagname:gsub("[[]","")t = t..
